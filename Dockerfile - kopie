#FROM airhacks/wildfly
#COPY ./target/coffee.war ${DEPLOYMENT_DIR}

FROM payara/server-full

ENV PAYARA_ARCHIVE payara41
ENV DOMAIN_NAME domain1
ENV INSTALL_DIR /opt
ENV PAYARA_HOME ${INSTALL_DIR}/payara41/glassfish
ENV EXEC ${PAYARA_HOME}/bin
ENV DEPLOYMENT_DIR ${PAYARA_HOME}/domains/${DOMAIN_NAME}/autodeploy/
ENV ARTIFACT s62
ENTRYPOINT bin/asadmin start-domain --verbose ${DOMAIN_NAME}
EXPOSE 4848 8009 8080 8181
#WORKDIR /opt/payara41/glassfish/bin
#COPY ./target/coffee.war /opt/payara41/glassfish/domains/domain1/autodeploy

RUN curl http://repo1.maven.org/maven2/mysql/mysql-connector-java/5.1.34/mysql-connector-java-5.1.38.jar -o glassfish/lib/mysql-connector-java-5.1.38.jar
RUN curl http://repo1.maven.org/maven2/mysql/mysql-connector-java/5.1.34/mysql-connector-java-5.1.38.jar -o glassfish/domains/domain1/lib/ext/mysql-connector-java-5.1.38.jar

COPY domain.xml glassfish/domains/domain1/config/domain.xml
COPY admin-keyfile glassfish/domains/domain1/config/admin-keyfile

COPY ./target/${ARTIFACT}.war ${DEPLOYMENT_DIR}

